Scripts used for phase-oscillator simulations relying on L and D functions 
derived from KaiC phosphorylation data (Fig. 4-figSup2)
**************************************************************************

To generate bootstrapped L and D functions from KaiC phosphorylation data
******************************************
1. Run globalFit_steps_NonParamBoot.m with NUMBOOT=no. bootstrapped datasets  you'd like to generate and derive L and D funs from. Set TOSAVESTEPFUNS=1 to save the output into a timestamped .mat file. One such output file is provided in saved_data/2016-10-31_stepFun_Lin-NLin-Oct_1000_2016-10-31_20.45.44.mat file.

To plot distribution of bootstrapped L and D functions (Fig. 4-figSup2(A-B))
******************************************************
1. Run plotNoisyLDfuns_NonParamBoot.m

To run simulations from bootstrapped L and D functions
******************
1. Open runPhOsc_Boot_LinNLin.m and enter appropriate parameters to 
drive the phase oscillator for specific day lengths, number of 
light-dark cycles, and driving periods (default=24 hrs).
2. In the INDIR and INFILE fields, enter the file name and directory of the 
file containing step-response functions you want to use in simulations. These
are typically previously generated by globalFit_steps_NonParamBoot.m and saved into a 
.mat file. An example file with 1000 bootstrapped sets of L, D, Llin, Dlin, Tlight and Tdark is provided in saved_data/2016-10-31_stepFun_Lin-NLin-Oct_1000_2016-10-31_20.45.44.mat file.
3. Hit run. Once complete, the program will generate a time-stamped file
TIMESTAMP_Lin.mat and TIMESTAMP_NonLin.mat files
that will contain your simulation results. The program will also save a timestamped version of the simulation script.

To plot simulation results in Fig. 4-figSup2(C). 
**************************
1. Open analyzePhOsc_Sims_Boot_LinNLin.m and enter the file names of the simulation datasets you want to process (generated by runPhOsc_BootLinNlin.m above). Examples of such datasets using both non-linear and linearized L and D are provided in saved_data/2017-03-29_NonLin_1000.mat and saved_data/2017-03-29_Lin_1000.mat.
2. Hit run -- this will generate the figure depicting entrained phases as a function of day length.

